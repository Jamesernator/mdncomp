"use strict";module.exports=init;const saves=[],options=require("commander"),version=require("../package.json").version,args=process.argv,log=console.log.bind(console);let mdn,shortPad=2;function init(){if(args.length===3&&(args[2]==="--update"||args[2]==="--fupdate")){update(args[2]==="--fupdate")}else{options.version(version,"-v, --version").usage("[options] <apipath>").description("Get MDN Browser Compatibility data."+lf+"  Version: "+version+lf+"  (c) 2018 K3N / epistemex.com").option("-l, --list","List paths starting with the given value or . for top-level").option("-o, --out <path>","Save information to file. Extension for type, or --type.").option("-t, --type <type>","Output format (ansi, txt, svg)","ansi").option("-x, --overwrite","Overwrites an existing file with --out option.").option("-d, --desktop","Show desktop only").option("-m, --mobile","Show mobile devices only").option("-c, --case-sensitive","Search in case-sensitive mode").option("-a, --show-all","If search results in more than entry, show info for all.").option("-s, --shorthand","Show compatibility as shorthand with multiple results").option("-b, --no-colors","Don't use colors in output",false).option("--max-chars <width>","Max number of chars per line before wrap.",72).option("-N, --no-notes","Don't show notes").option("-e, --noteend","Show notes (-n) at end instead of in sections (text)").option("-f, --markdown","Format link as markdown and turns off colors.").option("-w, --width <width>","Used with -o, Set width of image",800).option("--raw","Output the raw JSON data.").option("--update, --fupdate","Update MDN BCD data from remote (--fupdate forced update).").action(go).parse(args);if(!options.args.length)options.help()}}function outInfo(txt){if(Array.isArray(txt))txt=txt.join(lf);log(txt)}function outStore(txt,noFile){if(Array.isArray(txt))txt=txt.join(lf);if(noFile||!options.out)log(txt);else{saves.push(txt)}}function go(path){mdn=require("../data/data.json");if(options.update){log("Updating...");return}if(options.out&&options.type==="ansi")options.type=getExt(options.out||".txt");if(!options.colors||options.markdown||options.type==="txt"){Object.keys(ANSI).forEach(color=>{ANSI[color]=""})}if(options.list){if(path==="."){outInfo(listTopLevels())}else if(["deprecated","experimental"].indexOf(path)>=0){outInfo(listOnStatus(path))}else{let result=list(path,options.caseSensitive);outInfo(result)}}else{let result=search(path,options.caseSensitive);if(!result.length)outInfo("Not found.");else{if(result.length===1||options.showAll&&(options.type!=="svg"||options.raw)){if(options.shorthand)shortPad=getPadLength(result);result.forEach(entry=>{outResult(entry)});if(options.type!=="svg")outStore(ANSI.fgMagenta+"Data from MDN - `npm i -g mdncomp` by epistemex"+ANSI.fgWhite+lf);commit()}else{outInfo(result)}}}function outResult(entry){let compat=new MDNComp(entry);if(options.raw){outInfo(indent(JSON.stringify(getPathAsObject(compat.path,true))))}else if(options.type==="svg"){outStore(compatToSVG(compat))}else{outStore(options.shorthand?compatToShort(compat,shortPad):compatToLong(compat))}}function commit(){let fs;if(options.out&&saves.length){fs=require("fs");if(fs.existsSync(options.out)&&!options.overwrite){const readLine=require("readline"),rl=readLine.createInterface({input:process.stdin,output:process.stdout});rl.question(ANSI.fgYellow+"A file exist with this name. Overwrite (y, default no)? "+ANSI.fgWhite,resp=>{if(resp.toLowerCase()==="y"||resp.toLowerCase()==="yes")_save(function(){rl.close()});else{log("File not saved.");rl.close()}})}else _save()}function _save(callback){fs.writeFile(options.out,saves.join("\n"),"utf8",function(err){if(err)return log("An error occurred:"+lf+err);log('Saved output to file "'+options.out+'"!');if(callback)callback()})}}function getPadLength(list){let max=0;list.forEach(e=>{let len=(prePathFromPath(e)+nameFromPath(e)).length;if(len>max)max=len});return++max}}const ANSI={reset:"[0m",bright:"[1m",dim:"[2m",save:"7",restore:"8",clrToCursor:"[1K",cursorUp:"[1A",fgRed:"[31m",fgGreen:"[32m",fgYellow:"[33m",fgBlue:"[34m",fgMagenta:"[35m",fgCyan:"[36m",fgWhite:"[37m"};const lf="\r\n",yes="Y",no="-",yes16="âœ”",no16="âœ˜",px8="Â·Ã—Â·";String.prototype.center=function(length){let aLen=this.ansiLength(),pad=length-aLen>>>1,str="".padStart(pad)+this+"".padStart(pad);return" ".substr(0,length-str.ansiLength())+str};String.prototype.ansiLength=function(){return this.replace(/\x1b[^m]*m/g,"").length};function buildTable(){const result=[],keys=listTopLevels();keys.forEach(key1=>{if(key1!=="__compat")result.push(key1);Object.keys(mdn[key1]).forEach(key2=>{if(key2!=="__compat")result.push(key1+"."+key2);Object.keys(mdn[key1][key2]).forEach(key3=>{if(key3!=="__compat")result.push(key1+"."+key2+"."+key3)})})});return result.sort()}function listTopLevels(){return Object.keys(mdn)}function getComparer(str){if(!str.startsWith("*"))str="*"+str;if(!str.endsWith("*")&&!str.endsWith("."))str+="*";if(str.endsWith("."))str=str.substr(0,Math.max(0,str.length-1));return new RegExp("^"+str.split("*").join(".*")+"$")}function getPathAsObject(path,noChildren){let parts=path.split("."),obj=mdn;parts.forEach(part=>{if(obj&&obj[part])obj=obj[part]});if(noChildren){Object.keys(obj).forEach(key=>{if(obj&&obj[key].__compat)delete obj[key]})}return obj}function nameFromPath(path){let last=getExt(path);return last.length?last:path}function getExt(path){let i=path.lastIndexOf(".");return i<0?"":path.substr(++i)}function prePathFromPath(path){let parts=path.split("."),o=mdn,res="";parts.pop();parts.forEach(part=>{if(o){if(o[part].__compat)res+=part+".";o=o[part]}});return res.length>1?res:""}function isCompat(path){let obj=getPathAsObject(path);return obj?typeof obj.__compat!=="undefined":false}function cleanHTML(str){return str.replace(/(<([^>]+)>)/gi,"")}function breakLine(s,max){let out=new Output(0),_max=Math.max(62,max>>>0||72),line=s.substr(0,_max),i;while(line.length===_max){i=line.lastIndexOf(" ");if(i<0)i=_max;out.addLine(line.substr(0,i).trim());s=s.substr(i);line=s.substr(1,_max)}out.add(line.trim());return out.toString()}function indent(txt){let out="",level=0,i,ch;for(i=0;i<txt.length;i++){ch=txt[i];if(ch===","){out+=ch+lf+padding()}else if(ch==="{"){level++;out+=ch+lf+padding()}else if(ch==="}"){level--;out+=lf+padding()+ch}else if(ch===":"){out+=ch+" "}else out+=ch}function padding(){return"".padStart(level<<1," ")}return out}function update(force){const https=require("https"),path=require("path"),clr=ANSI.clrToCursor+ANSI.cursorUp;let data="",count=0,filePath=path.normalize(path.dirname(process.mainModule.filename)+"/../data/data.json");log(ANSI.fgGreen+ANSI.bright+"Connecting...");https.get("https://raw.githubusercontent.com/epistemex/data-for-mdncomp/master/data.json",res=>{const fs=require("fs");let dataLength=res.headers["content-length"]|0;let fileLength=fs.statSync(filePath).size;if(!force&&dataLength===fileLength){log(clr+ANSI.reset+ANSI.fgWhite+"No change - cancelling.")}else{if(res.statusCode===200){res.on("data",d=>{data+=d;log(clr+ANSI.fgWhite+"Downloading data "+ANSI.fgGreen+ANSI.bright+"".padStart(((count+=.25)|0)%50,"."))});res.on("end",()=>{log(clr+"".padStart(72," "));log(clr+ANSI.fgWhite+"Saving to: "+filePath);fs.writeFile(filePath,data,"utf8",err=>{if(err)log(ANSI.fgRed+"Could not write new data to file...",err,ANSI.fgWhite);else{log("Updated with "+data.length+" bytes. All systems are GO!")}})})}else{log("An unknown error occurred. Status code:",res.statusCode)}}}).on("error",err=>{log("An error occurred:",err,ANSI.reset+ANSI.fgWhite)})}function search(keyword,sensitive){let cmp=getComparer(sensitive?keyword:keyword.toLowerCase()),tbl=buildTable(),result=[];tbl.forEach(path=>{let _path=sensitive?path:path.toLowerCase();if(cmp.test(_path)&&isCompat(path))result.push(path)});return result}function list(prefix,sensitive){const _prefix=sensitive?prefix:prefix.toLowerCase(),tbl=buildTable(),result=[];tbl.forEach(path=>{let _path=sensitive?path:path.toLowerCase();if(_path.startsWith(_prefix)&&!isCompat(path))result.push(path)});return result.length===1?Object.keys(getPathAsObject(result[0])||{}):result}function listOnStatus(statTxt){const result=[],keys=listTopLevels();keys.forEach(key1=>{let o=mdn[key1];if(o.__compat&&_check(o))result.push(key1);Object.keys(mdn[key1]).forEach(key2=>{let o=mdn[key1][key2];if(o.__compat&&_check(o))result.push(key1+"."+key2);Object.keys(mdn[key1][key2]).forEach(key3=>{let o=mdn[key1][key2][key3];if(key3.__compat&&_check(o))result.push(key1+"."+key2+"."+key3)})})});function _check(compat){let status=compat.__compat.status||{};return!!status[statTxt]}return result.sort()}function compatToLong(mdnComp){let out=new Output(0),desktopList=["chrome","edge","firefox","ie","opera","safari"],mobileList=["webview_android","chrome_android","edge_mobile","firefox_android","opera_android","safari_ios"],refs=["Â¹","Â²","Â³","Âª","Âº","*","^","`","1","2","3","4","5"],ref=0,notes=[],opts={markdown:options.markdown,showDesktop:!options.mobile,showMobile:!options.desktop,showNotes:!options.noNotes,notesEnd:!!options.noteend};out.addLine(ANSI.reset);if(options.markdown&&mdnComp.url.length){out.addLine(" [`%0%1`](%2) %3"+lf,mdnComp.prePath,mdnComp.name,mdnComp.url,mdnComp.getStatus())}else{out.addLine(" %0%1%2%3%4 %5",ANSI.fgYellow,mdnComp.prePath,ANSI.fgCyan,mdnComp.name,ANSI.reset,mdnComp.getStatus());out.addLine(" ",mdnComp.url?mdnComp.url:"-",lf)}if(opts.showDesktop){out.addLine(" %0DESKTOP:",ANSI.fgYellow);out.addLine(" %0Chrome    %1|%0 Edge      %1|%0 Firefox   %1|%0 IE        %1|%0 Opera     %1|%0 Safari%1",ANSI.fgGreen+ANSI.bright,ANSI.reset);out.addLine(" %0----------+-----------+-----------+-----------+-----------+-----------%1",ANSI.fgWhite+ANSI.dim,ANSI.reset);versions(desktopList);out.addLine(lf);if(!options.noteend&&options.notes&&notes.length)out.addLine(notes.join(""));if(!options.noteend){notes=[];ref=0}}if(opts.showMobile){out.addLine(" %0MOBILE:",ANSI.fgYellow);out.addLine(" %0Webview/A %1|%0 Chrome/A  %1|%0 Edge/mob  %1|%0 Firefox/A %1|%0 Opera/A   %1|%0 Safari/iOS%1",ANSI.fgGreen+ANSI.bright,ANSI.reset);out.addLine(" %0----------+-----------+-----------+-----------+-----------+-----------%1",ANSI.fgWhite+ANSI.dim,ANSI.reset);versions(mobileList);out.addLine(lf);if(options.notes&&notes.length)out.addLine(notes.join(""))}function versions(list){let prefixList="";list.forEach(browserId=>{let browser=mdnComp.getBrowser(browserId),status,prefix;if(browser){status=browser.info[0].getVersion();prefix=browser.hasPrefix();if(prefix){if(prefixList.length)prefixList+=", "+browser.info[0].prefix;else prefixList=px8+") Prefix: "+browser.info[0].prefix}if(browser.hasNotes()){status+=ANSI.fgWhite+(options.notes?refs[ref]:"*")+ANSI.reset;notes.push(browser.getNotes(refs[ref]));ref++}else if(browser.hasPrefix()){status+=ANSI.fgWhite+px8+ANSI.reset}if(status==="?"){status=ANSI.fgYellow+"?"+ANSI.reset}}else{status=ANSI.fgRed+no+ANSI.reset}out.add("%0"+status.center(11)+"%1"+"|",status.indexOf(no)>=0?ANSI.fgRed:ANSI.fgCyan,ANSI.reset)});if(prefixList.length)notes.unshift(prefixList+lf);out.trimEnd(1)}out.trimEnd(1);return out.toString()}function compatToShort(mdnComp,shortPad){let prePath=mdnComp.prePath+mdnComp.name,out=new Output(0),desktopList=["chrome","edge","firefox","ie","opera","safari"],mobileList=["android","chrome_android","firefox_android","edge_mobile","opera_android","safari_ios"],desktopShort=["C:","E:","F:","IE:","O:","S:"],mobileShort=["WA:","CA:","FA:","EM:","OA:","Si:"],opts={markdown:options.markdown,showDesktop:!options.mobile,showMobile:!options.desktop,showNotes:!options.noNotes,notesEnd:!!options.noteend};out.add(prePath.padEnd(shortPad),":");if(opts.showDesktop){out.add("%0  DT: %1",ANSI.fgYellow,ANSI.reset);versions(desktopList,desktopShort)}if(opts.showMobile){out.add("%0  MOB: %1",ANSI.fgYellow,ANSI.reset);versions(mobileList,mobileShort)}function versions(list,shortList){list.forEach((browserId,index)=>{let browser=mdnComp.getBrowser(browserId),status;if(browser){status=browser.info[0].getVersion();if(browser.hasNotes())status+=ANSI.fgWhite+"*"+ANSI.reset}else{status=ANSI.fgRed+no+ANSI.reset}out.add(ANSI.fgGreen,ANSI.bright,shortList[index],ANSI.reset,status," ")})}out.trimEnd(1);return out.toString()}function compatToSVG(mdnComp){const out=new Output,desktopList=["chrome","edge","firefox","ie","opera","safari"],mobileListIcons=["android","chrome,android","edge","firefox,android","opera,android","safari"],desktopDesc=["Chrome","Edge","Firefox","IE","Opera","Safari"],mobileDesc=["Webview for Android","Chrome for Android","Edge for mobile","Firefox for Android","Opera for Android","Safari for iOS"],mobileList=["webview_android","chrome_android","edge_mobile","firefox_android","opera_android","safari_ios"],opts={showDesktop:!options.mobile,showMobile:!options.desktop,showNotes:!options.noNotes},col1=0,w=options.width,isMob=opts.showMobile,isDesk=opts.showDesktop,col2w=w-col1,colM=isMob&&isDesk?col2w/2+col1:col1,cols=isMob&&isDesk?12:6,step=col2w/cols,indent=20,iconSize=20,colIcon="#676769",colYes="#E4F7E1",colNo="#FBE3E3",col1h=50,col2h=45;let notes=[],ref=0,statusX=1,h=col1h+col2h*2,i,x;out.add('<svg xmlns="http://www.w3.org/2000/svg" %1width="%0">',options.width,mdnComp.url.length?'xmlns:xlink="http://www.w3.org/1999/xlink" ':"");out.add("\x3c!-- Made with mdncomp v. ",version," --\x3e");if(opts.showDesktop||opts.showMobile){addSymbol("chrome","M8.071 13.954l-4.579-7.931c2.932-3.671 7.445-6.023 12.508-6.023 5.857 0 10.978 3.148 13.767 7.844h-13.055c-0.235-0.020-0.472-0.031-0.711-0.031-3.809 0-7.018 2.614-7.929 6.142zM21.728 10.156h9.171c0.711 1.81 1.101 3.781 1.101 5.844 0 8.776-7.066 15.9-15.818 15.998l6.544-11.334c0.921-1.324 1.462-2.932 1.462-4.664 0-2.287-0.943-4.357-2.459-5.844zM10.188 16c0-3.205 2.607-5.813 5.813-5.813s5.813 2.607 5.813 5.813c0 3.205-2.608 5.813-5.813 5.813s-5.813-2.608-5.813-5.813zM18.193 23.889l-4.581 7.934c-7.704-1.153-13.613-7.797-13.613-15.822 0-2.851 0.746-5.526 2.053-7.845l6.532 11.314c1.308 2.785 4.14 4.718 7.415 4.718 0.759 0 1.495-0.104 2.193-0.299z");addSymbol("firefox","M31.954 10.442l-0.371 2.377c0 0-0.53-4.402-1.179-6.047-0.995-2.521-1.438-2.501-1.441-2.498 0.667 1.694 0.546 2.604 0.546 2.604s-1.181-3.219-4.303-4.243c-3.459-1.134-5.33-0.824-5.547-0.765-0.033-0-0.064-0-0.095-0 0.026 0.002 0.050 0.005 0.076 0.007-0.001 0.001-0.003 0.001-0.003 0.002 0.014 0.017 3.822 0.666 4.497 1.594 0 0-1.617 0-3.227 0.464-0.073 0.021 5.923 0.749 7.148 6.74 0 0-0.657-1.371-1.47-1.604 0.535 1.626 0.397 4.712-0.112 6.245-0.066 0.197-0.133-0.853-1.135-1.305 0.321 2.301-0.019 5.952-1.616 6.957-0.124 0.078 1.001-3.603 0.226-2.18-4.46 6.838-9.731 3.155-12.101 1.535 1.215 0.264 3.52-0.041 4.541-0.8 0.001-0.001 0.002-0.002 0.004-0.003 1.108-0.758 1.765-1.311 2.354-1.18s0.982-0.46 0.524-0.985c-0.459-0.526-1.572-1.249-3.079-0.855-1.063 0.278-2.379 1.454-4.389 0.264-1.543-0.914-1.688-1.673-1.702-2.199 0.038-0.186 0.086-0.361 0.143-0.52 0.178-0.496 0.716-0.646 1.015-0.764 0.508 0.087 0.946 0.246 1.405 0.481 0.006-0.153 0.008-0.356-0.001-0.586 0.044-0.088 0.017-0.352-0.054-0.674-0.041-0.322-0.107-0.655-0.211-0.959 0-0 0.001-0 0.001-0 0.002-0.001 0.003-0.001 0.005-0.002s0.005-0.004 0.007-0.006c0-0.001 0.001-0.001 0.001-0.002 0.003-0.004 0.005-0.008 0.006-0.015 0.032-0.144 0.376-0.423 0.804-0.722 0.383-0.268 0.834-0.553 1.19-0.774 0.314-0.195 0.554-0.34 0.605-0.378 0.019-0.015 0.042-0.032 0.068-0.051 0.005-0.004 0.009-0.007 0.014-0.011 0.003-0.002 0.006-0.005 0.009-0.007 0.169-0.135 0.421-0.389 0.474-0.924 0-0.001 0-0.002 0-0.004 0.002-0.016 0.003-0.032 0.004-0.048 0.001-0.011 0.002-0.023 0.002-0.034 0-0.009 0.001-0.018 0.001-0.027 0.001-0.021 0.002-0.043 0.002-0.065 0-0.001 0-0.002 0-0.004 0.001-0.052-0-0.106-0.003-0.163-0.002-0.032-0.004-0.060-0.009-0.086-0-0.001-0.001-0.003-0.001-0.004-0.001-0.003-0.001-0.005-0.002-0.008-0.001-0.005-0.002-0.009-0.004-0.013-0-0.001-0-0.001-0.001-0.001-0.002-0.005-0.004-0.010-0.005-0.014-0-0-0-0-0-0.001-0.055-0.128-0.26-0.177-1.108-0.191-0.001-0-0.002-0-0.002-0v0c-0.346-0.006-0.798-0.006-1.391-0.004-1.039 0.004-1.613-1.016-1.797-1.41 0.251-1.389 0.977-2.379 2.17-3.051 0.023-0.013 0.018-0.023-0.009-0.031 0.233-0.141-2.82-0.004-4.225 1.782-1.247-0.31-2.333-0.289-3.269-0.069-0.18-0.005-0.404-0.027-0.67-0.083-0.623-0.564-1.514-1.606-1.562-2.85 0 0-0.003 0.002-0.008 0.006-0.001-0.012-0.002-0.024-0.002-0.036 0 0-1.897 1.458-1.613 5.434-0.001 0.064-0.002 0.125-0.004 0.184-0.514 0.696-0.768 1.282-0.787 1.411-0.455 0.926-0.917 2.32-1.292 4.437 0 0 0.263-0.833 0.79-1.777-0.388 1.188-0.693 3.036-0.514 5.808 0 0 0.047-0.615 0.215-1.5 0.131 1.719 0.704 3.841 2.152 6.337 2.78 4.791 7.052 7.211 11.775 7.582 0.839 0.069 1.689 0.071 2.544 0.006 0.079-0.006 0.157-0.011 0.236-0.018 0.968-0.068 1.942-0.214 2.914-0.449 13.287-3.212 11.842-19.256 11.842-19.256z");addSymbol("edge","M0.481 14.206c0.938-7.4 5.987-14.113 15.037-14.206 5.463 0.106 9.956 2.581 12.631 7.3 1.344 2.462 1.762 5.050 1.85 7.906v3.356h-20.081c0.094 8.281 12.188 8 17.394 4.35v6.744c-3.050 1.831-9.969 3.469-15.325 1.363-4.563-1.712-7.813-6.488-7.794-11.081-0.15-5.956 2.962-9.9 7.794-12.144-1.025 1.269-1.806 2.669-2.213 5.094h11.338c0 0 0.663-6.775-6.419-6.775-6.675 0.231-11.488 4.112-14.213 8.094v0z");addSymbol("opera","M32 16v0 0c0 4.738-2.063 9-5.337 11.925-4.106 2-7.931 0.6-9.194-0.275 4.031-0.881 7.075-5.756 7.075-11.65s-3.044-10.769-7.075-11.656c1.269-0.875 5.094-2.275 9.194-0.275 3.275 2.931 5.337 7.194 5.337 11.931v0 0z","M10.731 6.981c-1.769 2.087-2.912 5.175-2.987 8.644 0 0.006 0 0.744 0 0.756 0.075 3.462 1.225 6.55 2.994 8.637 2.294 2.981 5.706 4.869 9.519 4.869 2.344 0 4.538-0.712 6.413-1.956-2.837 2.531-6.575 4.069-10.669 4.069-0.256 0-0.512-0.006-0.762-0.019-8.481-0.4-15.238-7.4-15.238-15.981 0-8.838 7.162-16 16-16 0.019 0 0.038 0 0.063 0 4.075 0.013 7.787 1.55 10.606 4.075-1.875-1.244-4.069-1.962-6.413-1.962-3.813 0-7.225 1.887-9.525 4.869z");addSymbol("ie","M22.944 19.651h7.377c0.057-0.512 0.080-1.034 0.080-1.569 0-2.507-0.673-4.858-1.848-6.883 1.215-3.228 1.172-5.968-0.455-7.606-1.547-1.54-5.697-1.29-10.388 0.787-0.347-0.026-0.697-0.040-1.051-0.040-6.439 0-11.841 4.431-13.335 10.402 2.020-2.586 4.145-4.461 6.984-5.826-0.258 0.242-1.764 1.739-2.018 1.993-7.486 7.484-9.847 17.26-7.306 19.8 1.931 1.93 5.43 1.604 9.449-0.364 1.869 0.952 3.984 1.488 6.226 1.488 6.035 0 11.15-3.885 13.003-9.295h-7.433c-1.023 1.887-3.023 3.171-5.319 3.171s-4.296-1.284-5.319-3.171c-0.455-0.852-0.716-1.83-0.716-2.864v-0.023h12.071zM10.884 16.025c0.171-3.035 2.694-5.456 5.774-5.456s5.604 2.421 5.774 5.456h-11.548zM28.030 5.119c1.048 1.059 1.021 3.007 0.125 5.438-1.535-2.341-3.766-4.186-6.4-5.239 2.816-1.207 5.106-1.367 6.274-0.199zM2.921 30.227c-1.337-1.337-0.934-4.144 0.788-7.526 1.072 3.008 3.161 5.534 5.854 7.161-2.982 1.354-5.423 1.584-6.643 0.365z");addSymbol("safari","M16 0c-8.837 0-16 7.163-16 16s7.163 16 16 16 16-7.163 16-16-7.163-16-16-16zM3 16c0-7.18 5.82-13 13-13 3.424 0 6.538 1.325 8.86 3.488l-12.86 5.512-5.512 12.86c-2.164-2.322-3.488-5.436-3.488-8.86zM18.286 18.286l-8.003 3.43 3.43-8.003 4.573 4.573zM16 29c-3.424 0-6.539-1.325-8.86-3.488l12.86-5.512 5.512-12.86c2.164 2.322 3.488 5.436 3.488 8.86 0 7.18-5.82 13-13 13z")}if(opts.showDesktop){addSymbol("desktop","M0 2v20h32v-20h-32zM30 20h-28v-16h28v16zM21 24h-10l-1 4-2 2h16l-2-2z")}if(opts.showMobile){addSymbol("mobile","M24 0h-18c-1.1 0-2 0.9-2 2v28c0 1.1 0.9 2 2 2h18c1.1 0 2-0.9 2-2v-28c0-1.1-0.9-2-2-2zM15 30.556c-0.859 0-1.556-0.697-1.556-1.556s0.697-1.556 1.556-1.556 1.556 0.697 1.556 1.556-0.697 1.556-1.556 1.556zM24 26h-18v-22h18v22z");addSymbol("android","M28 12c-1.1 0-2 0.9-2 2v8c0 1.1 0.9 2 2 2s2-0.9 2-2v-8c0-1.1-0.9-2-2-2zM4 12c-1.1 0-2 0.9-2 2v8c0 1.1 0.9 2 2 2s2-0.9 2-2v-8c0-1.1-0.9-2-2-2zM7 23c0 1.657 1.343 3 3 3v0 4c0 1.1 0.9 2 2 2s2-0.9 2-2v-4h4v4c0 1.1 0.9 2 2 2s2-0.9 2-2v-4c1.657 0 3-1.343 3-3v-11h-18v11z","M24.944 10c-0.304-2.746-1.844-5.119-4.051-6.551l1.001-2.001c0.247-0.494 0.047-1.095-0.447-1.342s-1.095-0.047-1.342 0.447l-1.004 2.009-0.261-0.104c-0.893-0.297-1.848-0.458-2.84-0.458s-1.947 0.161-2.84 0.458l-0.261 0.104-1.004-2.009c-0.247-0.494-0.848-0.694-1.342-0.447s-0.694 0.848-0.447 1.342l1.001 2.001c-2.207 1.433-3.747 3.805-4.051 6.551v1h17.944v-1h-0.056zM13 8c-0.552 0-1-0.448-1-1s0.447-0.999 0.998-1c0.001 0 0.002 0 0.003 0s0.001-0 0.002-0c0.551 0.001 0.998 0.448 0.998 1s-0.448 1-1 1zM19 8c-0.552 0-1-0.448-1-1s0.446-0.999 0.998-1c0 0 0.001 0 0.002 0s0.002-0 0.003-0c0.551 0.001 0.998 0.448 0.998 1s-0.448 1-1 1z")}if(mdnComp.hasFlags())addSymbol("flag","M0 0h4v32h-4v-32z","M26 20.094c2.582 0 4.83-0.625 6-1.547v-16c-1.17 0.922-3.418 1.547-6 1.547s-4.83-0.625-6-1.547v16c1.17 0.922 3.418 1.547 6 1.547z","M19 1.016c-1.466-0.623-3.61-1.016-6-1.016-3.012 0-5.635 0.625-7 1.547v16c1.365-0.922 3.988-1.547 7-1.547 2.39 0 4.534 0.393 6 1.016v-16z");if(mdnComp.standard)addSymbol("html5","M1.892 0l2.567 28.801 11.524 3.199 11.554-3.204 2.572-28.796h-28.216zM24.52 9.42h-13.517l0.322 3.617h12.874l-0.97 10.844-7.245 2.008-7.237-2.008-0.495-5.547h3.547l0.252 2.82 3.933 1.060 0.009-0.002 3.935-1.062 0.408-4.58h-12.242l-0.953-10.681h17.694l-0.316 3.532z");if(mdnComp.deprecated)addSymbol("thumb","M17 5c-0.755 0-1.438 0.289-1.965 0.751-0.064-0.062-0.116-0.14-0.188-0.192-0.96-0.737-3.665-1.559-5.847-1.559-1.879 0-2.607 0.293-3.252 0.552-0.103 0.042-0.207 0.085-0.316 0.124-0.834 0.305-1.578 1.229-1.738 2.2l-0.664 5.972c-0.174 1.039 0.441 2.127 1.4 2.478 0.394 0.144 2.512 0.405 3.883 0.56-0.215 1.256-0.312 2.405-0.312 3.616 0 1.379 1.121 2.5 2.5 2.5s2.5-1.121 2.5-2.5c0-1.875 0.667-2.737 1.616-3.699 0.548 0.724 1.408 1.199 2.384 1.199 1.653 0 2.999-1.347 2.999-3v-6c-0.001-1.656-1.346-3.002-3-3.002zM11 19.5c0 0.275-0.225 0.5-0.5 0.5s-0.5-0.225-0.5-0.5c0-1.805 0.256-3.241 0.479-4.293l0.297-1.398-1.321 0.188c-0.605-0.050-3.934-0.447-4.335-0.552-0.058-0.028-0.132-0.18-0.108-0.321l0.663-5.976c0.037-0.223 0.291-0.539 0.443-0.594 0.131-0.049 0.254-0.099 0.377-0.146 0.544-0.219 1.015-0.408 2.506-0.408 1.914 0 4.118 0.753 4.633 1.146 0.156 0.12 0.366 0.564 0.366 0.854v4.977c-0.001 0.026-0.040 0.649-0.707 1.316-0.913 0.913-2.293 2.293-2.293 5.207zM18 14c0 0.552-0.448 1-1 1s-1-0.448-1-1v-6c0-0.552 0.448-1 1-1s1 0.448 1 1v6z");if(mdnComp.experimental)addSymbol("lab","M29.884 25.14l-9.884-16.47v-6.671h1c0.55 0 1-0.45 1-1s-0.45-1-1-1h-10c-0.55 0-1 0.45-1 1s0.45 1 1 1h1v6.671l-9.884 16.47c-2.264 3.773-0.516 6.86 3.884 6.86h20c4.4 0 6.148-3.087 3.884-6.86zM7.532 20l6.468-10.779v-7.221h4v7.221l6.468 10.779h-16.935z");if(mdnComp.url.length)addSymbol("link","M6 2v24h24v-24h-24zM28 24h-20v-20h20v20zM4 28v-21l-2-2v25h25l-2-2h-21z","M11 8l5 5-6 6 3 3 6-6 5 5v-13z");if(mdnComp.url.length){out.add('<a xlink:href="%0" style="cursor:pointer" target="_blank">',mdnComp.url);text2(mdnComp.prePath,mdnComp.name,1,50,32);use("link",w-40,26,24,24,"#777");out.add("</a>")}else{text2(mdnComp.prePath,mdnComp.name,indent,50,32)}if(mdnComp.deprecated)status("thumb","Deprecated",24,"#a00");if(mdnComp.experimental)status("lab","Experimental",0,"#c70");if(mdnComp.standard)status("html5","On standard track",0,"#070");out.add('<g transform="translate(0, 104)">');rect(0,0,w,h,"#eaedf2");if(opts.showDesktop){versions(desktopList,desktopDesc,col1,col1h+col2h)}if(opts.showMobile){versions(mobileList,mobileDesc,colM,col1h+col2h)}for(x=col1;x<w;x+=step){line(x|0,col1h,x|0,h,1,"#999")}if(col1)line(col1,0,col1,h,2);if(isMob)line(colM,0,colM,h,2);line(col1,col1h,w,col1h,2);line(0,col1h+col2h,w,col1h+col2h,1);line(0,h,w,h,2);if(isDesk){use("desktop",((isMob?col2w/2:col2w)-iconSize)/2+col1,(col1h-iconSize)/2,iconSize,iconSize);for(i=0,x=col1;i<desktopList.length;i++){use(desktopList[i],x+step*i+(step-iconSize)/2,col1h+(col2h-iconSize)/2,iconSize,iconSize,colIcon,desktopDesc[i])}}if(isMob){use("mobile",((isDesk?col2w/2:col2w)-iconSize)/2+colM,(col1h-iconSize)/2,iconSize,iconSize);for(i=0,x=colM;i<mobileListIcons.length;i++){let lst=mobileListIcons[i].split(",");lst.forEach((icon,t)=>{use(icon,(lst.length===2?t?1.5:-1.5:0)+x+t*iconSize+step*i+(step-iconSize*lst.length)/2,col1h+(col2h-iconSize)/2,iconSize,iconSize,colIcon,mobileDesc[i])})}}if(options.notes&&notes.length){notes.forEach(note=>{h+=16;textFmt(note,w-indent*2)})}h+=45;text('Data from MDN - "npm i -g mdncomp" by epistemex Â© 2018.',1,h,14,true,"#777");out.add("</g></svg>");function versions(list,desc,offset,y){options.maxWidth=(w-60)/8;list.forEach((browserId,index)=>{let browser=mdnComp.getBrowser(browserId),status,refMark,flags,prefix,x=offset+step*index,tx=x+step*.5;if(browser){flags=browser.hasFlags();prefix=browser.hasPrefix();status=browser.info[0].getVersion().replace("Y",yes16);if(browser.hasNotes()){refMark=options.notes?++ref:"*";notes.push(browser.getNotes(ref))}}else{status=no}rect(x,y,step,col2h,status.indexOf("-")>=0?colNo:status==="?"?"#eaedf2":colYes);if(status==="-")text(no16,tx,y+28,0,0,"#c55","middle");else text(status,tx,y+28,w<800?12:0,0,status.indexOf("-")<0&&status.indexOf("?")<0?"#070":"#000","middle");if(refMark)text(refMark,x+step-11,y+13,10,"#000","end");if(flags)use("flag",x+5,y+5,10,10,"#555");if(prefix)text(browser.info[0].prefix,x+5,y+41,12,false,"#334")})}function status(icon,txt,size,color){size=size||14;let y=69;if(icon){use(icon,statusX,y+(size===14?2:1),size,size,color);statusX+=20}text(txt,statusX,y+15,16,true,color);statusX+=105}function line(x1,y1,x2,y2,lw,col){if(lw/2!==lw>>>1){x1+=.5;y1+=.5;x2+=.5;y2+=.5}out.add('<line x1="%0" y1="%1" x2="%2" y2="%3"  stroke="%5" stroke-width="%4" />',x1,y1,x2,y2,lw||1,col?col:"#000")}function rect(x,y,w,h,bgCol,title){out.add('<rect x="%0" y="%1" width="%2" height="%3" fill="%4"%5 />',x,y,w,h,bgCol,title?' title="'+title+'"':"")}function text(txt,x,y,size,sans,color,align){align=align?' text-anchor="'+align+'" ':"";out.add('<text x="%1" y="%2" fill="%5" %6font-family="%4" font-size="%3">%0</text>',txt,x,y,size||16,sans?"sans-serif":"Consolas, monospace",color?color:"#000",align)}function text2(txt1,txt2,x,y,size){out.add('<text x="%2" y="%3" font-family="Consolas, monospace" font-size="%4"><tspan fill="#777">%0</tspan><tspan fill="#000">%1</tspan>',txt1,txt2,x,y,size||16);out.add("</text>")}function link(txt,url,x,y,size){out.add('<a xlink:href="%0" style="cursor:pointer">',url);text(txt,x,y+size*1.25,size,true);out.add("</a>")}function textFmt(txt){let parts=txt.split(lf),res=new Output,height=0;parts.forEach(part=>{res.add('<tspan x="%0" dy="1.3em">',indent);res.add(part);res.add("</tspan>");height+=15});text(res.toString(),10,h,14);h+=height}function use(name,x,y,width,height,col,desc){col=col?' fill="'+col+'"':"";if(desc)out.add("<g><title>%0</title>",desc);if(arguments.length>3){out.add('<use href="#icon-%0" x="%1" y="%2" width="%3" height="%4"%5></use>',name,x,y,width,height,col)}else{out.add('<use href="#icon-%0" width="%1" height="%2"%3></use>',name,x,y,col)}if(desc)out.add("</g>")}function addSymbol(name,data){out.add('<symbol id="icon-%0" viewBox="-1 -1 34 34">',name);for(let i=1;i<arguments.length;i++)out.add('<path d="%0"></path>',arguments[i]);out.add("</symbol>")}return out.toString()}function MDNComp(path){let obj=getPathAsObject(path).__compat,names=["webview_android","chrome","chrome_android","edge","edge_mobile","firefox","firefox_android","ie","opera","opera_android","safari","safari_ios"],isDesktop=[false,true,false,true,false,true,false,true,true,false,true,false],status=obj.status||{},keys=Object.keys(obj.support);this.path=path;this.prePath=prePathFromPath(path);this.name=nameFromPath(path);this.url=obj.mdn_url||"";this.experimental=!!status.experimental;this.standard=!!status.standard_track;this.deprecated=!!status.deprecated;this.browsers=[];keys.forEach(key=>{let nameIndex=names.indexOf(key);if(nameIndex>=0){let browser=new Browser(obj,key);browser.isDesktop=isDesktop[nameIndex];this.browsers.push(browser)}})}MDNComp.prototype={getBrowser:function(name){for(let i=0;i<this.browsers.length;i++){if(this.browsers[i].name===name)return this.browsers[i]}return null},getStatus:function(){let txt="(";if(this.experimental)txt+=ANSI.fgYellow+"EXPERIMENTAL"+ANSI.reset+", ";if(this.deprecated)txt+=ANSI.fgRed+"DEPRECATED"+ANSI.reset+", ";if(this.standard)txt+=ANSI.fgGreen+ANSI.bright+"On Standard Track"+ANSI.reset+", ";txt=txt.substr(0,Math.max(1,txt.length-2))+")";return txt==="()"?"":txt},hasFlags:function(){for(let i=0;i<this.browsers.length;i++){if(this.browsers[i].hasFlags())return true}return false}};function Info(obj){this.prefix=obj.prefix||"";this.added=this.toStatus(obj.version_added);this.removed=this.toStatus(obj.version_removed);this.notes=obj.notes?Array.isArray(obj.notes)?obj.notes:[obj.notes]:[];this.partial=!!obj.partial_implementation;this.altName=obj.alternative_name||"";this.desc=obj.description||"";this.flags=obj.flags||[]}Info.prototype={getVersion:function(){return this.removed?this.added+"-"+this.removed.replace(yes,"?"):this.added},flagToString:function(flag){switch(flag.type){case"preference":return line("- Behind flag ");case"compile_flag":return line("- Compile with ");case"runtime_flag":return line("- Run with ")}function line(prefix){return prefix+flag.name+(flag.value_to_set?" set to "+flag.value_to_set+"":"")+"."}return""},toString:function(ref){const prefix=(ref?ref+") ":"")+(isNaN(this.added)?"":this.getVersion()+":")+lf;let out=new Output(0),hasInfo=false;if(this.prefix.length){hasInfo=true;out.addLine("- Prefix: "+this.prefix)}if(this.altName.length){hasInfo=true;out.addLine("- Alternative name: "+this.altName)}if(this.partial){hasInfo=true;out.addLine("- Is a partial implementation")}this.flags.forEach(flag=>{hasInfo=true;out.addLine(breakLine(cleanHTML(this.flagToString(flag)),options.maxWidth))});this.notes.forEach(note=>{hasInfo=true;out.addLine(breakLine(cleanHTML("- "+note),options.maxWidth))});return hasInfo?prefix+out.toString():""},toStatus:function(status){if(typeof status==="boolean")return status?yes:no;else if(null===status)return"?";return status?status:null}};function Browser(obj,name){this.name=name;this.info=[];let support=obj.support[name];if(!Array.isArray(support))support=[support];support.forEach(supportItem=>{this.info.push(new Info(supportItem))})}Browser.prototype={hasNotes:function(){for(let i=0;i<this.info.length;i++){if(this.info[i].notes.length)return true}return false},hasFlags:function(){for(let i=0;i<this.info.length;i++){if(this.info[i].flags.length)return true}return false},hasPrefix:function(){for(let i=0;i<this.info.length;i++){if(this.info[i].prefix.length)return true}return false},getNotes:function(ref){let out=new Output(0);this.info.forEach(info=>{out.add(info.toString(ref))});return out.toString()}};function Output(indent){this.string="";this.indent="    ".substr(0,indent|0);this.linefeed=lf}Output.prototype={add:function(txt){txt=txt?txt:"";if(arguments.length>1){let format=txt.indexOf("%0")>=0;for(let i=1;i<arguments.length;i++){let regEx=new RegExp("%"+(i-1),"g");txt=format?txt.replace(regEx,arguments[i]):txt+arguments[i]}}this.string+=this.indent+(txt||"")},addLine:function(txt){this.add.apply(this,arguments);this.string+=this.linefeed},trimEnd:function(n){this.string=this.string.substr(0,Math.max(0,this.string.length-n))},replace:function(keyword,newText){let regEx=new RegExp(keyword,"g");this.string=this.string.replace(regEx,newText)},toString:function(){return this.string}};